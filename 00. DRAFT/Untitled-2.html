<!DOCTYPE html>
<html lang='pl'>
<head>
<meta charset='UTF-8'>
<style>
    :root {
        --primary: #6b1718;
        --secondary: #8e2b2c;
        --accent: #d4573a;
        --bg: #f4f4f4;
        --card-bg: #ffffff;
        --text: #333;
        --code-bg: #f8f9fa;
        --border: #e1e4e8;
        --success: #28a745;
        --warning: #ffc107;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
        font-family: 'Segoe UI', -apple-system, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #f4f4f4 100%);
        color: var(--text);
        padding: 20px;
        line-height: 1.5;
    }

    /* ===== NAG≈Å√ìWEK ===== */
    .header { 
        text-align: center; 
        margin-bottom: 40px;
        animation: slideDown 0.6s ease;
    }
    .header h1 { 
        color: var(--primary); 
        font-size: 2.8rem; 
        margin-bottom: 5px; 
        text-transform: uppercase; 
        letter-spacing: 2px;
        font-weight: 400;
    }
    .header p { 
        color: #666; 
        font-size: 1.1rem;
        margin-bottom: 5px;
    }
    .header .subtitle {
        color: #666;
        font-size: 1.1rem;
        font-weight: 300;
    }

    /* ===== SIATKA 4x4 ===== */
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        max-width: 1400px;
        margin: 0 auto;
    }

    /* ===== KAFELKI ===== */
    .card {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 25px 20px;
        text-align: center;
        border: 2px solid rgba(0,0,0,0.05);
        box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        overflow: hidden;
    }
    .card:hover {
        transform: translateY(-8px);
        box-shadow: 0 16px 32px rgba(107, 23, 24, 0.2);
        border-color: var(--primary);
    }
    .card::before {
        content: ''; 
        position: absolute; 
        top: 0; 
        left: -100%; 
        width: 100%; 
        height: 3px;
        background: linear-gradient(90deg, transparent, var(--primary), transparent);
        transition: left 0.5s;
    }
    .card:hover::before { left: 100%; }

    .icon { 
        width: 52px; 
        height: 52px; 
        margin-bottom: 15px; 
        fill: none; 
        stroke: var(--primary); 
        stroke-width: 1.8; 
        stroke-linecap: round; 
        stroke-linejoin: round; 
        display: inline-block;
        transition: transform 0.3s;
    }
    .card:hover .icon { transform: scale(1.1) rotate(5deg); }
    
    .card h2 { 
        font-size: 1.3rem; 
        margin-bottom: 8px; 
        color: #222;
        font-weight: 700;
    }
    .card p { 
        font-size: 0.9rem; 
        color: #777;
        line-height: 1.4;
    }

    /* ===== MODAL ===== */
    .modal-overlay {
        position: fixed; 
        top: 0; 
        left: 0; 
        width: 100%; 
        height: 100%;
        background: rgba(0,0,0,0.6); 
        backdrop-filter: blur(4px);
        display: none; 
        align-items: center; 
        justify-content: center; 
        z-index: 1000;
        opacity: 0; 
        transition: opacity 0.3s;
    }
    .modal-overlay.active { 
        display: flex; 
        opacity: 1; 
    }

    .modal {
        background: #fff; 
        width: 95%; 
        max-width: 900px; 
        max-height: 85vh;
        border-radius: 16px; 
        display: flex; 
        flex-direction: column;
        box-shadow: 0 30px 60px rgba(0,0,0,0.3);
        animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
        from { transform: scale(0.9) translateY(20px); opacity: 0; }
        to { transform: scale(1) translateY(0); opacity: 1; }
    }

    .modal-header {
        padding: 25px 30px; 
        border-bottom: 2px solid var(--border);
        display: flex; 
        justify-content: space-between; 
        align-items: center;
        background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
        border-radius: 16px 16px 0 0;
    }
    .modal-header h2 { 
        color: var(--primary); 
        font-size: 1.8rem; 
        margin: 0;
        font-weight: 800;
    }
    .close { 
        background: none; 
        border: none; 
        font-size: 2.2rem; 
        color: #999; 
        cursor: pointer; 
        line-height: 1;
        transition: color 0.2s;
    }
    .close:hover { 
        color: var(--primary); 
    }

    .modal-content { 
        padding: 30px; 
        overflow-y: auto;
        flex: 1;
    }
    .modal-content::-webkit-scrollbar {
        width: 8px;
    }
    .modal-content::-webkit-scrollbar-track {
        background: #f1f1f1;
    }
    .modal-content::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 4px;
    }

    /* ===== TRE≈öƒÜ FUNKCJI ===== */
    .section-title {
        font-size: 1.15rem; 
        font-weight: 800; 
        color: var(--primary); 
        margin: 25px 0 15px 0;
        border-left: 5px solid var(--accent); 
        padding-left: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .section-title:first-child { 
        margin-top: 0; 
    }
    
    .func-row { 
        margin-bottom: 18px; 
        padding-bottom: 15px;
        border-bottom: 1px dashed #eee;
    }
    .func-row:last-child {
        border-bottom: none;
    }

    .func-name { 
        font-family: 'Consolas', 'Monaco', monospace; 
        color: #005cc5; 
        font-weight: 800; 
        background: #eaf5ff; 
        padding: 4px 8px; 
        border-radius: 4px; 
        font-size: 0.96rem;
        display: inline-block;
        margin-bottom: 6px;
    }
    .func-desc { 
        margin: 6px 0; 
        font-size: 0.95rem; 
        color: #555;
        line-height: 1.5;
    }
    .func-example {
        font-size: 0.85rem;
        color: #666;
        margin-top: 4px;
        font-style: italic;
    }
    
    pre {
        background: #fafafa; 
        color: #121212; 
        padding: 14px 16px; 
        border-radius: 6px;
        overflow-x: auto; 
        font-family: 'Consolas', 'Monaco', monospace; 
        font-size: 0.9rem; 
        margin: 8px 0 0 0;
        border-left: 4px solid var(--accent);
        line-height: 1.4;
    }

    .kwd { color: #ff79c6; font-weight: bold; }
    .func { color: #a00e09; font-weight: bold; }
    .str { color: #a00e09; }
    .comment { color: #75715e; font-style: italic; }
    .num { color: #ae81ff; }

    /* ===== TIP BOX ===== */
    .tip {
        background: #e8f5e9;
        border-left: 4px solid #4caf50;
        padding: 12px 14px;
        margin: 12px 0;
        border-radius: 4px;
        font-size: 0.9rem;
        color: #2e7d32;
    }
    .tip strong { color: #1b5e20; }

    .warning {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 12px 14px;
        margin: 12px 0;
        border-radius: 4px;
        font-size: 0.9rem;
        color: #856404;
    }

    /* ===== ANIMACJA ===== */
    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* ===== RESPONSYWNO≈öƒÜ ===== */
    @media (max-width: 768px) {
        .grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .header h1 { font-size: 2rem; }
        .modal { width: 98%; max-height: 90vh; }
        .modal-header h2 { font-size: 1.3rem; }
        .modal-content { padding: 20px; }
    }

    @media (max-width: 480px) {
        .grid { grid-template-columns: 1fr; }
        .header h1 { font-size: 1.6rem; }
    }
</style>
</head>
<body>

<div class='header'>
    <h1> DAX Master Board</h1>
    <p class='subtitle'>Kompletny przewodnik po funkcjach DAX z praktycznymi przyk≈Çadami</p>
</div>

<div class='grid'>
    <div class='card' onclick='openModal("agg")'>
        <svg class='icon' viewBox='0 0 24 24'><line x1='12' y1='20' x2='12' y2='10'></line><line x1='18' y1='20' x2='18' y2='4'></line><line x1='6' y1='20' x2='6' y2='16'></line></svg>
        <h2>Agregacje</h2>
        <p>SUM, AVG, COUNT, DISTINCT, Iteratory</p>
    </div>
    <div class='card' onclick='openModal("filter")'>
        <svg class='icon' viewBox='0 0 24 24'><polygon points='22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3'></polygon></svg>
        <h2>Filtry i Logika</h2>
        <p>CALCULATE, ALL, KEEPFILTERS, REMOVEFILTERS</p>
    </div>
    <div class='card' onclick='openModal("time")'>
        <svg class='icon' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10'></circle><polyline points='12 6 12 12 16 14'></polyline></svg>
        <h2>Time Intelligence</h2>
        <p>YTD, TOTALYTD, DATEADD, DATESINYEAR</p>
    </div>
    <div class='card' onclick='openModal("date")'>
        <svg class='icon' viewBox='0 0 24 24'><rect x='3' y='4' width='18' height='18' rx='2' ry='2'></rect><line x1='16' y1='2' x2='16' y2='6'></line><line x1='8' y1='2' x2='8' y2='6'></line></svg>
        <h2>Data i Czas</h2>
        <p>TODAY, YEAR, MONTH, DATEDIFF, EOMONTH</p>
    </div>
    <div class='card' onclick='openModal("text")'>
        <svg class='icon' viewBox='0 0 24 24'><polyline points='4 7 4 4 20 4 20 7'></polyline><line x1='9' y1='20' x2='15' y2='20'></line><line x1='12' y1='4' x2='12' y2='20'></line></svg>
        <h2>Tekst</h2>
        <p>FORMAT, LEFT, SEARCH, SUBSTITUTE, UNICHAR</p>
    </div>
    <div class='card' onclick='openModal("logic")'>
        <svg class='icon' viewBox='0 0 24 24'><path d='M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z'></path></svg>
        <h2>Logika (IF)</h2>
        <p>IF, SWITCH, AND, OR, NOT</p>
    </div>
    <div class='card' onclick='openModal("numbers")'>
        <svg class='icon' viewBox='0 0 24 24'><circle cx='9' cy='9' r='7'></circle><circle cx='9' cy='9' r='4'></circle><line x1='16' y1='16' x2='20' y2='20'></line></svg>
        <h2>Liczby i ZaokrƒÖgl.</h2>
        <p>ROUND, INT, ABS, POWER, SQRT, MOD</p>
    </div>
    <div class='card' onclick='openModal("tables")'>
        <svg class='icon' viewBox='0 0 24 24'><rect x='3' y='3' width='18' height='18' rx='2' ry='2'></rect><line x1='3' y1='9' x2='21' y2='9'></line><line x1='9' y1='3' x2='9' y2='21'></line></svg>
        <h2>Tabele i Relacje</h2>
        <p>RELATED, RELATEDTABLE, VALUES, DISTINCT</p>
    </div>
    <div class='card' onclick='openModal("stats")'>
        <svg class='icon' viewBox='0 0 24 24'><polyline points='23 6 13.5 15.5 8.5 10.5 1 17'></polyline><polyline points='17 6 23 6 23 12'></polyline></svg>
        <h2>Statystyka</h2>
        <p>STDEV, VAR, PERCENTILE, MEDIAN</p>
    </div>
    <div class='card' onclick='openModal("currency")'>
        <svg class='icon' viewBox='0 0 24 24'><line x1='12' y1='1' x2='12' y2='23'></line><path d='M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6'></path></svg>
        <h2>Waluta i Format</h2>
        <p>TEXT, FORMAT, FIXED, GENERATESERIES</p>
    </div>
    <div class='card' onclick='openModal("context")'>
        <svg class='icon' viewBox='0 0 24 24'><circle cx='12' cy='12' r='1'></circle><circle cx='19' cy='12' r='1'></circle><circle cx='5' cy='12' r='1'></circle></svg>
        <h2>Nawiasy i Kontekst</h2>
        <p>ALLEXCEPT, ALLSELECTED, ISINSCOPE, TREATAS</p>
    </div>
    <div class='card' onclick='openModal("errors")'>
        <svg class='icon' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10'></circle><line x1='12' y1='8' x2='12' y2='12'></line><line x1='12' y1='16' x2='12.01' y2='16'></line></svg>
        <h2>B≈Çƒôdy i Walidacja</h2>
        <p>IFERROR, IFNA, ISERROR, ISBLANK, ERROR</p>
    </div>
    <div class='card' onclick='openModal("collections")'>
        <svg class='icon' viewBox='0 0 24 24'><path d='M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7'></path><path d='M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z'></path></svg>
        <h2>Kolekcje i Iteracja</h2>
        <p>GENERATE, UNION, EXCEPT, INTERSECT, CROSSJOIN</p>
    </div>
    <div class='card' onclick='openModal("window")'>
        <svg class='icon' viewBox='0 0 24 24'><polyline points='3 3 21 3 21 21 3 21 3 3'></polyline><line x1='3' y1='9' x2='21' y2='9'></line><line x1='9' y1='3' x2='9' y2='21'></line></svg>
        <h2>Window Functions</h2>
        <p>OFFSET, WINDOW, INDEX, RANK</p>
    </div>
    <div class='card' onclick='openModal("advanced")'>
        <svg class='icon' viewBox='0 0 24 24'><path d='M12 2L2 7l10 5 10-5-10-5z'></path><path d='M2 17l10 5 10-5'></path><path d='M2 12l10 5 10-5'></path></svg>
        <h2>Zaawansowany CALCULATE</h2>
        <p>USERELATIONSHIP, CROSSFILTER, Filter Arguments</p>
    </div>
    <div class='card' onclick='openModal("best")'>
        <svg class='icon' viewBox='0 0 24 24'><path d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'></path></svg>
        <h2>Best Practices</h2>
        <p>Wskaz√≥wki, optymalizacja, pu≈Çapki, wzorce</p>
    </div>
</div>

<!-- ================= MODALE ================= -->

<!-- MODAL 1: AGREGACJE -->
<div id='modal-agg' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2> Agregacje</h2><button class='close' onclick='closeById("agg")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Podstawowe Funkcje Aggregate</div>
            <div class='func-row'>
                <span class='func-name'>SUM(kolumna)</span>
                <div class='func-desc'>Sumuje wszystkie warto≈õci numeryczne w kolumnie.</div>
                <pre><span class='func'>SUM</span>(Sales[Amount])</pre>
                <div class='tip'><strong>üí° Tip:</strong> SUM automatycznie ignoruje BLANKi. To najwydajniejsza funkcja do sum.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>AVERAGE(kolumna)</span>
                <div class='func-desc'>Oblicza ≈õredniƒÖ arytmetycznƒÖ warto≈õci (ignoruje BLANK i FALSE).</div>
                <pre><span class='func'>AVERAGE</span>(Sales[Amount])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>MIN / MAX</span>
                <div class='func-desc'>Zwraca najmniejszƒÖ lub najwiƒôkszƒÖ warto≈õƒá z kolumny.</div>
                <pre>Min Price = <span class='func'>MIN</span>(Products[Price])
Max Price = <span class='func'>MAX</span>(Products[Price])</pre>
            </div>
            <div class='section-title'>Liczenie (Counting)</div>
            <div class='func-row'>
                <span class='func-name'>COUNT(kolumna)</span>
                <div class='func-desc'>Liczy liczby ca≈Çkowite i dziesiƒôtne. Ignoruje BLANK i TRUE/FALSE.</div>
                <pre>Rows = <span class='func'>COUNT</span>(Sales[Amount])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>COUNTA(kolumna)</span>
                <div class='func-desc'>Liczy wszystkie niepuste warto≈õci (teksty, liczby, logika, b≈Çƒôdy).</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>COUNTROWS(tabela)</span>
                <div class='func-desc'>Liczy wszystkie wiersze w tabeli. NAJWYDAJNIEJSZA dla liczenia wierszy.</div>
                <pre>Total Transactions = <span class='func'>COUNTROWS</span>(Sales)</pre>
                <div class='tip'><strong>‚úÖ Best Practice:</strong> Zawsze u≈ºywaj COUNTROWS zamiast COUNT(*) lub COUNT(kolumna) do liczenia wierszy!</div>
            </div>
            <div class='section-title'>Unikalne Warto≈õci</div>
            <div class='func-row'>
                <span class='func-name'>DISTINCTCOUNT(kolumna)</span>
                <div class='func-desc'>Liczy unikalne (distinct) warto≈õci w kolumnie. BLANK liczony oddzielnie.</div>
                <pre>Unique Customers = <span class='func'>DISTINCTCOUNT</span>(Sales[CustomerKey])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>DISTINCTCOUNTNOBLANK(kolumna)</span>
                <div class='func-desc'>Jak DISTINCTCOUNT, ale ignoruje BLANK warto≈õci.</div>
            </div>
            <div class='section-title'>Funkcje Iteracyjne (Funkcje X)</div>
            <div class='func-row'>
                <span class='func-name'>SUMX(tabela, wyra≈ºenie)</span>
                <div class='func-desc'>Iteruje po ka≈ºdym wierszu tabeli, oblicza wyra≈ºenie, sumuje wyniki.</div>
                <pre>Margin = <span class='func'>SUMX</span>(Sales, 
    Sales[Qty] * (Sales[Price] - Sales[Cost]))</pre>
                <div class='warning'><strong>‚ö†Ô∏è Uwaga:</strong> SUMX mo≈ºe byƒá wolny dla du≈ºych zbior√≥w danych. Preferuj obliczenia w Power Query.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>AVERAGEX / MINX / MAXX</span>
                <div class='func-desc'>Jak SUMX, ale oblicza ≈õredniƒÖ, minimum lub maksimum po iteracji.</div>
                <pre>Avg Margin % = <span class='func'>AVERAGEX</span>(Sales,
    (Sales[Price] - Sales[Cost]) / Sales[Price])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>RANKX(tabela, wyra≈ºenie, [warto≈õƒá], [porzƒÖdek])</span>
                <div class='func-desc'>Ranguje warto≈õci wyra≈ºenia w kontek≈õcie tabeli.</div>
                <pre>Sales Rank = <span class='func'>RANKX</span>(<span class='func'>ALL</span>(Customers), [Sales], , 0)</pre>
                <div class='tip'><strong>üí° Parametry:</strong> 0 = malejƒÖcy (du≈ºe pierwsze), 1 = rosnƒÖcy (ma≈Çe pierwsze).</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 2: FILTRY I LOGIKA -->
<div id='modal-filter' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2> Filtry i Logika</h2><button class='close' onclick='closeById("filter")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>CALCULATE - Kr√≥lem DAX</div>
            <div class='func-row'>
                <span class='func-name'>CALCULATE(wyra≈ºenie, [filtr1], [filtr2], ...)</span>
                <div class='func-desc'>Zmienia kontekst filtra dla wyra≈ºenia. Jedyna funkcja (poza CALCULATETABLE) kt√≥ra to robi.</div>
                <pre>Red Sales = <span class='func'>CALCULATE</span>(
    [Sales],
    Products[Color] = <span class='str'>"Red"</span>
)</pre>
                <div class='tip'><strong>üí° Wskaz√≥wka:</strong> CALCULATE to 80% sk≈Çadni ka≈ºdej zaawansowanej miary DAX.</div>
            </div>
            <div class='section-title'>Usuwanie Filtr√≥w</div>
            <div class='func-row'>
                <span class='func-name'>ALL([tabela], [kolumna1], [kolumna2], ...)</span>
                <div class='func-desc'>Usuwa wszystkie filtry z wymienionych kolumn. Zwraca tabelƒô bez filtr√≥w.</div>
                <pre>% of Total = [Sales] / <span class='func'>CALCULATE</span>([Sales], <span class='func'>ALL</span>(Sales))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>ALLEXCEPT(tabela, [kolumna1], [kolumna2], ...)</span>
                <div class='func-desc'>Usuwa filtry ze WSZYSTKIEGO OPR√ìCZ wymienionych kolumn.</div>
                <pre>Sales by Category = <span class='func'>CALCULATE</span>(
    [Sales],
    <span class='func'>ALLEXCEPT</span>(Products, Products[Category])
)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>REMOVEFILTERS()</span>
                <div class='func-desc'>Alias dla ALL, u≈ºywany jako modyfikator wewnƒÖtrz CALCULATE. Nie zwraca tabeli.</div>
            </div>
            <div class='section-title'>Zachowanie Kontekstu Filtra</div>
            <div class='func-row'>
                <span class='func-name'>ALLSELECTED([kolumna])</span>
                <div class='func-desc'>Zwraca wszystkie wiersze WIDOCZNE w bie≈ºƒÖcym zapytaniu (respektuje slicery i filtry zewnƒôtrzne).</div>
                <pre>% of Selected = [Sales] / <span class='func'>CALCULATE</span>(
    [Sales], 
    <span class='func'>ALLSELECTED</span>(Sales[Date])
)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>KEEPFILTERS(filter_argument)</span>
                <div class='func-desc'>Dodaje filtr do kontekstu zamiast go nadpisywaƒá. Bardzo rzadko u≈ºywane.</div>
            </div>
            <div class='section-title'>Relacje</div>
            <div class='func-row'>
                <span class='func-name'>USERELATIONSHIP(col1, col2)</span>
                <div class='func-desc'>Aktywuje NIEAKTYWNƒÑ relacjƒô na czas tego obliczenia.</div>
                <pre>Ship Sales = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>USERELATIONSHIP</span>(Sales[ShipDate], 
        Dates[Date]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>CROSSFILTER(col1, col2, direction)</span>
                <div class='func-desc'>Zmienia kierunek filtrowania: Both, Single (domy≈õlnie), None.</div>
                <pre><span class='func'>CALCULATE</span>([Sales],
    <span class='func'>CROSSFILTER</span>(Sales[Date], 
        Dates[Date], Both))</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 3: TIME INTELLIGENCE -->
<div id='modal-time' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2> Time Intelligence</h2><button class='close' onclick='closeById("time")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>YTD, QTD, MTD Sumy</div>
            <div class='func-row'>
                <span class='func-name'>TOTALYTD(wyra≈ºenie, <date>, [filter])</span>
                <div class='func-desc'>Sumuje warto≈õƒá od 1 stycznia bie≈ºƒÖcego roku do wybranej daty.</div>
                <pre>YTD Sales = <span class='func'>TOTALYTD</span>([Sales], 
    <span class='func'>MAX</span>(Dates[Date]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>TOTALQTD / TOTALMTD</span>
                <div class='func-desc'>Jak TOTALYTD, ale od poczƒÖtku kwarta≈Çu / miesiƒÖca.</div>
            </div>
            <div class='section-title'>Przesuniƒôcia w Czasie</div>
            <div class='func-row'>
                <span class='func-name'>SAMEPERIODLASTYEAR(<date_kolumna>)</span>
                <div class='func-desc'>Zwraca ten sam zbi√≥r dat przesuniƒôty o rok wstecz.</div>
                <pre>Prior Year = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>SAMEPERIODLASTYEAR</span>(Dates[Date]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>DATEADD(<date_kolumna>, liczba, interwa≈Ç)</span>
                <div class='func-desc'>NAJWYDAJNIEJSZA. Przesuwa daty o N interwa≈Ç√≥w (DAY, MONTH, QUARTER, YEAR).</div>
                <pre>Prev Month = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>DATEADD</span>(Dates[Date], -1, MONTH))</pre>
                <div class='tip'><strong>‚úÖ Best Practice:</strong> U≈ºyj DATEADD zamiast SAMEPERIODLASTYEAR - jest szybsza!</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>PARALLELPERIOD(<date_kolumna>, liczba, interwa≈Ç)</span>
                <div class='func-desc'>Zwraca PE≈ÅNY okres (ca≈Çe miesiƒÖce), nawet je≈õli filtr zawiera tylko czƒô≈õƒá miesiƒÖca.</div>
            </div>
            <div class='section-title'>Okresy Niestandardowe</div>
            <div class='func-row'>
                <span class='func-name'>DATESINPERIOD(<date_kolumna>, data_poczƒÖtkowa, liczba, interwa≈Ç)</span>
                <div class='func-desc'>Zwraca tabelƒô dat z okre≈õlonego przedzia≈Çu. Idealne do ≈õrednich ruchomych 3M.</div>
                <pre>Rolling 3M = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>DATESINPERIOD</span>(Dates[Date], 
        <span class='func'>MAX</span>(Dates[Date]), -3, MONTH))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>DATESYTD / DATESQTD / DATESMTD</span>
                <div class='func-desc'>ZwracajƒÖ tabelƒô dat od poczƒÖtku roku/kwarta≈Çu/miesiƒÖca do wybranej daty.</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 4: DATA I CZAS -->
<div id='modal-date' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2> Data i Czas (Podstawowe)</h2><button class='close' onclick='closeById("date")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Bie≈ºƒÖca Data i Godzina</div>
            <div class='func-row'>
                <span class='func-name'>TODAY()</span>
                <div class='func-desc'>Zwraca bie≈ºƒÖcƒÖ datƒô (bez godziny) w momencie od≈õwie≈ºania raportu.</div>
                <pre>Days Ago = <span class='func'>DATEDIFF</span>(TODAY(), Sales[Date], DAY)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>NOW()</span>
                <div class='func-desc'>Zwraca bie≈ºƒÖcƒÖ datƒô Z GODZINƒÑ w momencie od≈õwie≈ºania.</div>
            </div>
            <div class='section-title'>Tworzenie Daty</div>
            <div class='func-row'>
                <span class='func-name'>DATE(rok, miesiƒÖc, dzie≈Ñ)</span>
                <div class='func-desc'>Tworzy datƒô ze sk≈Çadnik√≥w (liczby ca≈Çkowite).</div>
                <pre>Year End = <span class='func'>DATE</span>(YEAR(TODAY()), 12, 31)</pre>
            </div>
            <div class='section-title'>Ekstrakcja Sk≈Çadnik√≥w</div>
            <div class='func-row'>
                <span class='func-name'>YEAR / MONTH / DAY(data)</span>
                <div class='func-desc'>Pobiera rok, miesiƒÖc lub dzie≈Ñ z daty.</div>
                <pre>Year = <span class='func'>YEAR</span>(Sales[Date])
Month = <span class='func'>MONTH</span>(Sales[Date])
Day = <span class='func'>DAY</span>(Sales[Date])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>WEEKNUM(data, [return_type])</span>
                <div class='func-desc'>Zwraca numer tygodnia w roku (1-53).</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>WEEKDAY(data, [return_type])</span>
                <div class='func-desc'>Zwraca dzie≈Ñ tygodnia (1=niedziela, 7=sobota, domy≈õlnie).</div>
            </div>
            <div class='section-title'>Obliczenia na Datach</div>
            <div class='func-row'>
                <span class='func-name'>DATEDIFF(data1, data2, interwa≈Ç)</span>
                <div class='func-desc'>Liczy r√≥≈ºnicƒô miƒôdzy dwiema datami. Interwa≈Çy: DAY, MONTH, YEAR, HOUR, MINUTE, SECOND.</div>
                <pre>Days Late = <span class='func'>DATEDIFF</span>(Sales[OrderDate], 
    Sales[ShipDate], DAY)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>EOMONTH(data, [liczba_miesiƒôcy])</span>
                <div class='func-desc'>Zwraca ostatni dzie≈Ñ miesiƒÖca, przesuniƒôty opcjonalnie o N miesiƒôcy.</div>
                <pre>End Next Month = <span class='func'>EOMONTH</span>(TODAY(), 1)</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 5: TEKST -->
<div id='modal-text' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Funkcje Tekstowe</h2><button class='close' onclick='closeById("text")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Manipulacja CiƒÖgu</div>
            <div class='func-row'>
                <span class='func-name'>LEFT(tekst, liczba_znak√≥w)</span>
                <div class='func-desc'>Wycina N znak√≥w z LEWEJ strony ciƒÖgu.</div>
                <pre>Code = <span class='func'>LEFT</span>([FullCode], 3)  <span class='comment'>// np "ABC123" ‚Üí "ABC"</span></pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>RIGHT(tekst, liczba_znak√≥w)</span>
                <div class='func-desc'>Wycina N znak√≥w z PRAWEJ strony ciƒÖgu.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>MID(tekst, poczƒÖtek, liczba_znak√≥w)</span>
                <div class='func-desc'>Wycina N znak√≥w ze ≈öRODKA, zaczynajƒÖc od pozycji poczƒÖtek.</div>
                <pre>Area = <span class='func'>MID</span>([Code], 4, 2)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>LEN(tekst)</span>
                <div class='func-desc'>Zwraca d≈Çugo≈õƒá tekstu (liczbƒô znak√≥w).</div>
            </div>
            <div class='section-title'>Konkatenacja</div>
            <div class='func-row'>
                <span class='func-name'>CONCATENATE(tekst1, tekst2, ...)</span>
                <div class='func-desc'>≈ÅƒÖczy teksty. Rzadko u≈ºywane - lepiej u≈ºyj operatora &.</div>
                <pre>Full = [First] & <span class='str'>"  "</span> & [Last]</pre>
            </div>
            <div class='section-title'>Szukanie i Zamiana</div>
            <div class='func-row'>
                <span class='func-name'>SEARCH(szukany_tekst, tekst, [poczƒÖtek])</span>
                <div class='func-desc'>Szuka tekstu i zwraca pozycjƒô. NIE rozr√≥≈ºnia wielko≈õci liter.</div>
                <pre>Has Email = <span class='func'>SEARCH</span>(<span class='str'>"@"</span>, [Email]) <> <span class='num'>0</span></pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>FIND(szukany_tekst, tekst, [poczƒÖtek])</span>
                <div class='func-desc'>Jak SEARCH, ale ROZR√ì≈ªNIA wielko≈õƒá liter.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>SUBSTITUTE(tekst, stary, nowy, [liczba_wystƒÖpie≈Ñ])</span>
                <div class='func-desc'>Podmienia wszystkie (lub N-te) wystƒÖpienia starego tekstu na nowy.</div>
                <pre>Clean Phone = <span class='func'>SUBSTITUTE</span>([Phone], <span class='str'>"("</span>, <span class='str'>""</span>)</pre>
            </div>
            <div class='section-title'>Formatowanie Tekstu</div>
            <div class='func-row'>
                <span class='func-name'>FORMAT(warto≈õƒá, format_ciƒÖg)</span>
                <div class='func-desc'>Konwertuje warto≈õƒá (datƒô, liczbƒô) na tekst w wybranym formacie.</div>
                <pre>Month Label = <span class='func'>FORMAT</span>([Date], <span class='str'>"YYYY-MM"</span>)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>UPPER / LOWER(tekst)</span>
                <div class='func-desc'>Konwertuje tekst na WIELKIE / ma≈Çe litery.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>TRIM(tekst)</span>
                <div class='func-desc'>Usuwa spacje z poczƒÖtku i ko≈Ñca tekstu.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>UNICHAR(liczba)</span>
                <div class='func-desc'>Zwraca znak Unicode o danym numerze (np. strza≈Çki, symbole).</div>
                <pre>Trend = <span class='func'>IF</span>([Change]>0, 
    <span class='func'>UNICHAR</span>(9650), <span class='comment'>// ‚ñ≤</span>
    <span class='func'>UNICHAR</span>(9660))  <span class='comment'>// ‚ñº</span></pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 6: LOGIKA IF -->
<div id='modal-logic' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Logika (IF)</h2><button class='close' onclick='closeById("logic")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Instrukcja Warunkowa</div>
            <div class='func-row'>
                <span class='func-name'>IF(warunek, warto≈õƒá_je≈õli_prawda, warto≈õƒá_je≈õli_fa≈Çsz)</span>
                <div class='func-desc'>Zwraca jednƒÖ z dw√≥ch warto≈õci w zale≈ºno≈õci od warunku.</div>
                <pre>Status = <span class='func'>IF</span>([Sales] > 1000, 
    <span class='str'>"High"</span>, 
    <span class='str'>"Low"</span>)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>SWITCH(wyra≈ºenie, warto≈õƒá1, wynik1, warto≈õƒá2, wynik2, ..., [domy≈õlnie])</span>
                <div class='func-desc'>Wybiera wynik na podstawie dopasowania wyra≈ºenia do wielu warto≈õci. Lepsze od zagnie≈ºd≈ºonych IF.</div>
                <pre>Category = <span class='func'>SWITCH</span>([Region],
    <span class='str'>"North"</span>, <span class='str'>"PL-North"</span>,
    <span class='str'>"South"</span>, <span class='str'>"PL-South"</span>,
    <span class='str'>"Unknown"</span>)</pre>
                <div class='tip'><strong>‚úÖ Best Practice:</strong> SWITCH jest bardziej czytelny ni≈º zagnie≈ºd≈ºone IF.</div>
            </div>
            <div class='section-title'>Operatory Logiczne</div>
            <div class='func-row'>
                <span class='func-name'>AND(logika1, logika2, ...)</span>
                <div class='func-desc'>Zwraca TRUE je≈õli WSZYSTKIE warunki sƒÖ PRAWDZIWE.</div>
                <pre>Big Order = <span class='func'>IF</span>(
    <span class='func'>AND</span>([Qty] > 100, [Value] > 5000),
    <span class='str'>"Yes"</span>, <span class='str'>"No"</span>)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>OR(logika1, logika2, ...)</span>
                <div class='func-desc'>Zwraca TRUE je≈õli PRZYNAJMNIEJ JEDEN warunek jest PRAWDZIWY.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>NOT(logika)</span>
                <div class='func-desc'>Odwraca logikƒô: TRUE ‚Üí FALSE, FALSE ‚Üí TRUE.</div>
                <pre>Not USA = <span class='func'>NOT</span>([Country] = <span class='str'>"USA"</span>)</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 7: LICZBY -->
<div id='modal-numbers' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Liczby i ZaokrƒÖglenie</h2><button class='close' onclick='closeById("numbers")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>ZaokrƒÖglenie</div>
            <div class='func-row'>
                <span class='func-name'>ROUND(liczba, liczba_miejsc_dziesiƒôtnych)</span>
                <div class='func-desc'>ZaokrƒÖgla do N miejsc dziesiƒôtnych (standardowe regu≈Çy zaokrƒÖglania).</div>
                <pre>Price = <span class='func'>ROUND</span>([Cost] * 1.3, 2)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>ROUNDUP / ROUNDDOWN(liczba, liczba_miejsc)</span>
                <div class='func-desc'>ZaokrƒÖgla ZAWSZE w g√≥rƒô lub w d√≥≈Ç.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>INT(liczba)</span>
                <div class='func-desc'>Obcina czƒô≈õƒá dziesiƒôtnƒÖ (zaokrƒÖglanie w d√≥≈Ç dla liczb dodatnich).</div>
                <pre>Full Years = <span class='func'>INT</span>(<span class='func'>DATEDIFF</span>(Birth, TODAY(), DAY) / 365.25)</pre>
            </div>
            <div class='section-title'>Warto≈õƒá Bezwzglƒôdna</div>
            <div class='func-row'>
                <span class='func-name'>ABS(liczba)</span>
                <div class='func-desc'>Zwraca warto≈õƒá bezwzglƒôdnƒÖ (zawsze dodatnia).</div>
                <pre>Variance = <span class='func'>ABS</span>([Budget] - [Actual])</pre>
            </div>
            <div class='section-title'>Potƒôga i Pierwiastek</div>
            <div class='func-row'>
                <span class='func-name'>POWER(liczba, potƒôga)</span>
                <div class='func-desc'>Podnosi liczbƒô do potƒôgi.</div>
                <pre>Compound = [Principal] * <span class='func'>POWER</span>(1 + [Rate], [Years])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>SQRT(liczba)</span>
                <div class='func-desc'>Zwraca pierwiastek kwadratowy.</div>
            </div>
            <div class='section-title'>Pozosta≈Çe</div>
            <div class='func-row'>
                <span class='func-name'>MOD(liczba, dzielnik)</span>
                <div class='func-desc'>Zwraca resztƒô z dzielenia.</div>
                <pre>Is Even = <span class='func'>MOD</span>([Number], 2) = 0</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>SIGN(liczba)</span>
                <div class='func-desc'>Zwraca -1 (ujemna), 0 (zero) lub 1 (dodatnia).</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 8: TABELE I RELACJE -->
<div id='modal-tables' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Tabele i Relacje</h2><button class='close' onclick='closeById("tables")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Pobieranie Warto≈õci ze –°–≤—è–∑–∞–Ω–æ–≥–æ Wiersza</div>
            <div class='func-row'>
                <span class='func-name'>RELATED(kolumna_z_innej_tabeli)</span>
                <div class='func-desc'>Zwraca warto≈õƒá z wiersza POWIƒÑZANEJ tabeli (po relacji 1-do-wielu).</div>
                <pre>Category = <span class='func'>RELATED</span>(Products[Category])</pre>
                <div class='warning'><strong>‚ö†Ô∏è Uwaga:</strong> RELATED dzia≈Ça tylko w kierunku relacji (od Many do One). Dla kierunku odwrotnego u≈ºyj RELATEDTABLE.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>RELATEDTABLE(tabela)</span>
                <div class='func-desc'>Zwraca TABELƒò powiƒÖzanych wierszy z drugiej strony relacji (One-do-Many).</div>
                <pre>Total Orders = <span class='func'>SUMX</span>(
    <span class='func'>RELATEDTABLE</span>(Orders),
    Orders[Amount])</pre>
            </div>
            <div class='section-title'>Unikalne Warto≈õci</div>
            <div class='func-row'>
                <span class='func-name'>VALUES(kolumna)</span>
                <div class='func-desc'>Zwraca tabelƒô UNIKATOWYCH warto≈õci z kolumny w bie≈ºƒÖcym kontek≈õcie filtra.</div>
                <pre>Unique = <span class='func'>COUNTROWS</span>(<span class='func'>VALUES</span>([Product]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>DISTINCT(kolumna)</span>
                <div class='func-desc'>Zwraca tabelƒô UNIKATOWYCH warto≈õci (ignoruje BLANK).</div>
            </div>
            <div class='section-title'>Pobieranie Tabel</div>
            <div class='func-row'>
                <span class='func-name'>SELECTEDVALUE(kolumna, [warto≈õƒá_domy≈õlna])</span>
                <div class='func-desc'>Zwraca jedynƒÖ wybranƒÖ warto≈õƒá lub warto≈õƒá domy≈õlnƒÖ (je≈õli 0 lub wiele zaznaczonych).</div>
                <pre>Current Category = <span class='func'>SELECTEDVALUE</span>(
    Products[Category], 
    <span class='str'>"All"</span>)</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 9: STATYSTYKA -->
<div id='modal-stats' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Statystyka</h2><button class='close' onclick='closeById("stats")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Odchylenie Standardowe i Wariancja</div>
            <div class='func-row'>
                <span class='func-name'>STDEV.S / STDEV.P(kolumna)</span>
                <div class='func-desc'>Odchylenie standardowe: S = pr√≥ba, P = populacja.</div>
                <pre>StdDev = <span class='func'>STDEV.S</span>(Sales[Amount])</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>VAR.S / VAR.P(kolumna)</span>
                <div class='func-desc'>Wariancja (kwadrat odchylenia standardowego).</div>
            </div>
            <div class='section-title'>Percentyle i Mediana</div>
            <div class='func-row'>
                <span class='func-name'>PERCENTILE.INC(kolumna, k)</span>
                <div class='func-desc'>Zwraca k-ty percentyl (0-1). 0.5 = mediana, 0.25 = Q1, 0.75 = Q3.</div>
                <pre>Median = <span class='func'>PERCENTILE.INC</span>(Sales[Amount], 0.5)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>PERCENTILE.EXC(kolumna, k)</span>
                <div class='func-desc'>Jak PERCENTILE.INC, ale wy≈ÇƒÖczajƒÖc warto≈õci graniczne (zamiast je w≈ÇƒÖczaƒá).</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 10: WALUTA I FORMAT -->
<div id='modal-currency' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Waluta i Format</h2><button class='close' onclick='closeById("currency")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>TEXT vs FORMAT</div>
            <div class='func-row'>
                <span class='func-name'>TEXT(warto≈õƒá, format_ciƒÖg)</span>
                <div class='func-desc'>Konwertuje warto≈õƒá na tekst w formacie Excel/VBA (.NET style).</div>
                <pre>Revenue = <span class='func'>TEXT</span>([Sales], <span class='str'>"$#,##0.00"</span>)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>FORMAT(warto≈õƒá, format_ciƒÖg)</span>
                <div class='func-desc'>Konwertuje warto≈õƒá na tekst. Wspiera bardziej nowoczesne formaty (C# .NET).</div>
                <pre>Date = <span class='func'>FORMAT</span>([Date], <span class='str'>"yyyy-MM-dd HH:mm:ss"</span>)</pre>
            </div>
            <div class='section-title'>Fixed Point</div>
            <div class='func-row'>
                <span class='func-name'>FIXED(liczba, [liczba_miejsc], [bez_separator√≥w])</span>
                <div class='func-desc'>Konwertuje liczbƒô na tekst z okre≈õlonƒÖ liczbƒÖ miejsc dziesiƒôtnych.</div>
                <pre>Formatted = <span class='func'>FIXED</span>([Amount], 2)</pre>
            </div>
            <div class='section-title'>Generowanie Serii</div>
            <div class='func-row'>
                <span class='func-name'>GENERATESERIES(poczƒÖtek, koniec, [krok])</span>
                <div class='func-desc'>Generuje tabelƒô liczb od poczƒÖtek do koniec z opcjonalnym krokiem.</div>
                <pre>Numbers = <span class='func'>GENERATESERIES</span>(1, 100, 5)</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 11: NAWIASY I KONTEKST -->
<div id='modal-context' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>‚ü® ‚ü© Nawiasy i Kontekst</h2><button class='close' onclick='closeById("context")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Zaawansowane Usuwanie Filtr√≥w</div>
            <div class='func-row'>
                <span class='func-name'>ALLEXCEPT(tabela, [kolumna1], [kolumna2], ...)</span>
                <div class='func-desc'>Usuwa wszystkie filtry OPR√ìCZ wymienionych.</div>
                <pre>Total by Cat = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>ALLEXCEPT</span>(Products, Products[Category]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>ALLSELECTED([kolumna])</span>
                <div class='func-desc'>Respektuje bie≈ºƒÖce zaznaczenia i filtry slicer√≥w (bardziej subtelne ni≈º ALL).</div>
            </div>
            <div class='section-title'>Zakresy Filtr√≥w</div>
            <div class='func-row'>
                <span class='func-name'>ISINSCOPE(kolumna)</span>
                <div class='func-desc'>Zwraca TRUE je≈õli kolumna jest w bie≈ºƒÖcym zakresie (hierarchii wizualizacji).</div>
                <pre>Show Detail = <span class='func'>IF</span>(
    <span class='func'>ISINSCOPE</span>(Products[Category]), 1, 0)</pre>
            </div>
            <div class='section-title'>Mapowanie Kolumn</div>
            <div class='func-row'>
                <span class='func-name'>TREATAS(kolumna1, kolumna2)</span>
                <div class='func-desc'>Mapuje warto≈õci z jednej kolumny na warto≈õci innej (zaawansowany - rzadko).</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 12: B≈ÅƒòDY I WALIDACJA -->
<div id='modal-errors' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>B≈Çƒôdy i Walidacja</h2><button class='close' onclick='closeById("errors")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Obs≈Çuga B≈Çƒôd√≥w</div>
            <div class='func-row'>
                <span class='func-name'>IFERROR(wyra≈ºenie, warto≈õƒá_je≈õli_b≈ÇƒÖd)</span>
                <div class='func-desc'>Zwraca wyra≈ºenie, je≈õli jest poprawne; w przeciwnym razie zwraca warto≈õƒá zastƒôpczƒÖ.</div>
                <pre>Ratio = <span class='func'>IFERROR</span>([Amount] / [Cost], 0)</pre>
                <div class='tip'><strong>üí° Wskaz√≥wka:</strong> U≈ºywaj IFERROR zamiast IF z ISERROR - jest bardziej czytelny.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>IFNA(wyra≈ºenie, warto≈õƒá_je≈õli_na)</span>
                <div class='func-desc'>Jak IFERROR, ale reaguje TYLKO na #N/A (nie na inne b≈Çƒôdy).</div>
            </div>
            <div class='section-title'>Sprawdzenie B≈Çƒôdu</div>
            <div class='func-row'>
                <span class='func-name'>ISERROR(wyra≈ºenie)</span>
                <div class='func-desc'>Zwraca TRUE je≈õli wyra≈ºenie generuje b≈ÇƒÖd, FALSE w przeciwnym razie.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>ISBLANK(wyra≈ºenie)</span>
                <div class='func-desc'>Zwraca TRUE je≈õli wyra≈ºenie to BLANK (brak warto≈õci).</div>
                <pre>Has Data = <span class='func'>NOT</span>(<span class='func'>ISBLANK</span>([Amount]))</pre>
            </div>
            <div class='section-title'>Generowanie B≈Çƒôdu</div>
            <div class='func-row'>
                <span class='func-name'>ERROR(tekst_b≈Çƒôdu)</span>
                <div class='func-desc'>Generuje b≈ÇƒÖd z podanym komunikatem (zaawansowane, rzadko).</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 13: KOLEKCJE I ITERACJA -->
<div id='modal-collections' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Kolekcje i Iteracja</h2><button class='close' onclick='closeById("collections")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Operacje na Tabelach</div>
            <div class='func-row'>
                <span class='func-name'>GENERATE(tabela1, tabela2)</span>
                <div class='func-desc'>Iteruje po wiersza tabeli1 i dla ka≈ºdego wiersza oblicza tabelƒô2 w tym kontek≈õcie.</div>
                <pre>Product Sales = <span class='func'>GENERATE</span>(
    Products,
    <span class='func'>CALCULATETABLE</span>(Sales,
        Products[ID] = EARLIER(Products[ID])))</pre>
            </div>
            <div class='section-title'>Operacje Zbiorowe</div>
            <div class='func-row'>
                <span class='func-name'>UNION(tabela1, tabela2, ...)</span>
                <div class='func-desc'>≈ÅƒÖczy wiele tabel w jednƒÖ (zwraca UNIKALNE wiersze).</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>EXCEPT(tabela1, tabela2)</span>
                <div class='func-desc'>Zwraca wiersze z tabeli1, kt√≥re nie sƒÖ w tabeli2.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>INTERSECT(tabela1, tabela2)</span>
                <div class='func-desc'>Zwraca WSP√ìLNE wiersze z obu tabel.</div>
            </div>
            <div class='section-title'>Iloczyn Kartezja≈Ñski</div>
            <div class='func-row'>
                <span class='func-name'>CROSSJOIN(tabela1, tabela2, ...)</span>
                <div class='func-desc'>Zwraca WSZYSTKIE kombinacje wierszy (iloczyn kartezja≈Ñski).</div>
                <pre>All Combos = <span class='func'>CROSSJOIN</span>(Products, Dates)</pre>
                <div class='warning'><strong>‚ö†Ô∏è Uwaga:</strong> Mo≈ºe generowaƒá bardzo du≈ºe tabele! 1000 √ó 1000 = 1M wierszy.</div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 14: WINDOW FUNCTIONS -->
<div id='modal-window' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Window Functions (DAX 2021+)</h2><button class='close' onclick='closeById("window")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Window Functions (Nowsze Wersje)</div>
            <div class='func-row'>
                <span class='func-name'>WINDOW(wyra≈ºenie, od, do, [sorty], [przesuniƒôcie])</span>
                <div class='func-desc'>Zaawansowana funkcja. Pozwala na okna dynamiczne (np. poprzednie 3 wiersze).</div>
                <pre><span class='comment'>// Wymaga DAX 2021+ i Power BI Desktop 2021+</span>
Prev = <span class='func'>WINDOW</span>(1, -1, 0)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>INDEX(wyra≈ºenie, pozycja, [sorty])</span>
                <div class='func-desc'>Zwraca warto≈õƒá wyra≈ºenia z okre≈õlonej pozycji w oknie.</div>
            </div>
            <div class='func-row'>
                <span class='func-name'>OFFSET(wyra≈ºenie, liczba_wierszy, [sorty])</span>
                <div class='func-desc'>Przesuniƒôcie o N wierszy wzglƒôdem bie≈ºƒÖcego wiersza.</div>
            </div>
            <div class='tip'><strong>‚ÑπÔ∏è Info:</strong> Funkcje Window wymagajƒÖ Power BI Desktop z kwietnia 2021 lub nowszego. Zaawansowane!</div>
        </div>
    </div>
</div>

<!-- MODAL 15: ZAAWANSOWANY CALCULATE -->
<div id='modal-advanced' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Zaawansowany CALCULATE</h2><button class='close' onclick='closeById("advanced")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Modyfikatory Filtr√≥w</div>
            <div class='func-row'>
                <span class='func-name'>CALCULATE([wyra≈ºenie], kolumna = warto≈õƒá)</span>
                <div class='func-desc'>Podstawowy modyfikator: filtruj kolumnƒô na jednƒÖ warto≈õƒá.</div>
                <pre>Red Sales = <span class='func'>CALCULATE</span>([Sales], Products[Color] = <span class='str'>"Red"</span>)</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>CALCULATE([wyra≈ºenie], kolumna IN {...})</span>
                <div class='func-desc'>Filtruj na wielu warto≈õciach naraz.</div>
                <pre>Top Colors = <span class='func'>CALCULATE</span>([Sales],
    Products[Color] IN {<span class='str'>"Red"</span>, <span class='str'>"Blue"</span>, <span class='str'>"Green"</span>})</pre>
            </div>
            <div class='section-title'>Zaawansowane Techniki</div>
            <div class='func-row'>
                <span class='func-name'>USERELATIONSHIP + CALCULATE</span>
                <div class='func-desc'>Aktywuj nieaktywnƒÖ relacjƒô tylko dla tego obliczenia.</div>
                <pre>Ship Date Sales = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>USERELATIONSHIP</span>(Sales[ShipDate], Dates[Date]))</pre>
            </div>
            <div class='func-row'>
                <span class='func-name'>CROSSFILTER + CALCULATE</span>
                <div class='func-desc'>Zmie≈Ñ kierunek filtrowania relacji (Both, Single, None).</div>
                <pre>Bidirectional = <span class='func'>CALCULATE</span>([Sales],
    <span class='func'>CROSSFILTER</span>(Sales[DateKey], Dates[DateKey], Both))</pre>
            </div>
            <div class='section-title'>Kontekst Wiersza</div>
            <div class='func-row'>
                <span class='func-name'>EARLIER(kolumna, [liczba_poziom√≥w])</span>
                <div class='func-desc'>Zwraca warto≈õƒá kolumny z zewnƒôtrznego kontekstu (przydatne w iteratorach).</div>
                <pre>Outer = <span class='func'>SUMX</span>(Table,
    <span class='func'>EARLIER</span>([Value], 1))</pre>
            </div>
        </div>
    </div>
</div>

<!-- MODAL 16: BEST PRACTICES -->
<div id='modal-best' class='modal-overlay' onclick='closeModal(event)'>
    <div class='modal'>
        <div class='modal-header'><h2>Best Practices</h2><button class='close' onclick='closeById("best")'>&times;</button></div>
        <div class='modal-content'>
            <div class='section-title'>Performance Tips</div>
            <div class='func-row'>
                <div class='func-desc'><strong>1. Unikaj X-Functions w du≈ºych tabelach</strong></div>
                <pre>‚ùå <span class='func'>SUMX</span>(Sales, Sales[Qty] * Sales[Price])</pre>
                <pre>‚úÖ Zamiast tego utw√≥rz kolumnƒô w Power Query</pre>
                <div class='warning'><strong>‚ö†Ô∏è:</strong> SUMX iteruje - wolne dla milion√≥w wierszy!</div>
            </div>
            <div class='func-row'>
                <div class='func-desc'><strong>2. U≈ºyj ALL zamiast REMOVEFILTERS w CALCULATE</strong></div>
                <pre>‚úÖ <span class='func'>CALCULATE</span>([Sales], <span class='func'>ALL</span>(Date))</pre>
                <pre>‚ùå Unikaj: <span class='func'>CALCULATE</span>([Sales], <span class='func'>REMOVEFILTERS</span>(Date))</pre>
            </div>
            <div class='func-row'>
                <div class='func-desc'><strong>3. Preferuj COUNTROWS zamiast COUNT</strong></div>
                <pre>‚úÖ <span class='func'>COUNTROWS</span>(Sales)  <span class='comment'>// szybko</span>
‚ùå <span class='func'>COUNT</span>(Sales[Amount])  <span class='comment'>// wolniej</span></pre>
            </div>
            <div class='section-title'>Kod i Czysto≈õƒá</div>
            <div class='func-row'>
                <div class='func-desc'><strong>4. Nazwy miar: PascalCase, opisowe</strong></div>
                <pre>‚úÖ Total Sales by Region
‚ùå ts, Sales2, x</pre>
            </div>
            <div class='func-row'>
                <div class='func-desc'><strong>5. Komentarze dla z≈Ço≈ºonych wyra≈ºe≈Ñ</strong></div>
                <pre><span class='comment'>// YTD calculation with specific date column</span>
YTD Sales = <span class='func'>TOTALYTD</span>([Sales], MAX(Dates[Date]))</pre>
            </div>
            <div class='func-row'>
                <div class='func-desc'><strong>6. Formatowanie: wciƒôcia, nawiasy, spacje</strong></div>
                <pre>‚úÖ Czytelne:
<span class='func'>CALCULATE</span>(
    [Sales],
    Products[Color] = <span class='str'>"Red"</span>,
    <span class='func'>ALL</span>(Date)
)</pre>
            </div>
            <div class='section-title'>Pu≈Çapki do Unikania</div>
            <div class='func-row'>
                <div class='func-desc'><strong>7. BLANK vs 0</strong></div>
                <div class='warning'><strong>Pamiƒôtaj:</strong> BLANK ‚â† 0. W sumach BLANK jest ignorowany, 0 jest dodawany!</div>
            </div>
            <div class='func-row'>
                <div class='func-desc'><strong>8. Kontekst Wiersza vs Filtra</strong></div>
                <div class='tip'><strong>üí°:</strong> Row context = w kolumnach; Filter context = w miarach. CALCULATE przechodzi miƒôdzy nimi!</div>
            </div>
        </div>
    </div>
</div>

<script>
    function openModal(id) {
        var el = document.getElementById('modal-' + id);
        if(el) {
            el.classList.add('active');
            document.body.style.overflow = 'hidden'; 
        }
    }
    function closeById(id) {
        var el = document.getElementById('modal-' + id);
        if(el) {
            el.classList.remove('active');
            document.body.style.overflow = '';
        }
    }
    function closeModal(e) {
        if (e.target.classList.contains('modal-overlay')) {
            e.target.classList.remove('active');
            document.body.style.overflow = '';
        }
    }
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            var active = document.querySelectorAll('.modal-overlay.active');
            active.forEach(function(m){ m.classList.remove('active'); });
            document.body.style.overflow = '';
        }
    });
</script>

</body>
</html>

---
type: gaps
---

# Podstawowa składnia CALCULATE

Chcesz obliczyć sprzedaż tylko dla kategorii NAPOJE. Jak uzupełnić funkcję CALCULATE?

## Dostępne funkcje
- CALCULATE
- SUM
- [Sprzedaż Netto]
- dKategorie[Kategoria]

## Kod do uzupełnienia

```dax
DAX
Sprzedaż Napoje =
[SLOT:0](
    [SLOT:1],
    [SLOT:2] = ”NAPOJE”
)
```

## Poprawne rozwiązanie
CALCULATE, [Sprzedaż Netto], dKategorie[Kategoria]

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

Podstawowa składnia CALCULATE to: `CALCULATE(<wyrażenie/miara>, <filtr1>, <filtr2>, ...)`. W tym przypadku: `CALCULATE([Sprzedaż Netto], dKategorie[Kategoria] = NAPOJE)`. Funkcja CALCULATE oblicza miarę z dodanym filtrem na kategorię.

## Wskazówka
Funkcja kluczowa w DAX do modyfikowania kontekstu ma w nazwie słowo oblicz (ang. calculate).

---

# REMOVEFILTERS - usuwanie filtrów

Chcesz obliczyć sprzedaż dla całego okresu, ignorując filtry kalendarzowe nałożone na wizualizację. Jakiej funkcji użyć?

## Dostępne funkcje
- ALL
- REMOVEFILTERS
- CLEARFILTERS
- Obie: ALL i REMOVEFILTERS

## Kod do uzupełnienia

```dax
DAX
Sprzedaż Cały Okres =
CALCULATE(
    [Sprzedaż Netto],
    [SLOT:0](dKalendarz)
)
```

## Poprawne rozwiązanie
Obie: ALL i REMOVEFILTERS

## Feedback poprawny
✅ **Brawo! Rozwiązanie poprawne!**

Obie funkcje `ALL(dKalendarz)` i `REMOVEFILTERS(dKalendarz)` działają identycznie w kontekście CALCULATE - usuwają filtry z tabeli. `REMOVEFILTERS()` jest nowszą, bardziej czytelną wersją. Zaleca się używać `REMOVEFILTERS()` ze względu na jasność nazwy, ale `ALL()` nadal działa.


## Wskazówka
Materiał wspomina, że funkcja ALL ma nowszy odpowiednik o bardziej czytelnej nazwie. Czy tylko jedna z nich jest poprawna?

---

# Operator IN - wiele wartości

Chcesz policzyć sprzedaż dla kategorii NAPOJE lub SŁODYCZE. Jak najeleganciej to zapisać?

## Dostępne funkcje
- dKategorie[Kategoria] = NAPOJE || dKategorie[Kategoria] = SŁODYCZE
- dKategorie[Kategoria] IN {NAPOJE, SŁODYCZE}
- dKategorie[Kategoria] = {NAPOJE, SŁODYCZE}
- OR(dKategorie[Kategoria] = NAPOJE, SŁODYCZE)

## Kod do uzupełnienia

```dax
DAX
Sprzedaż Napoje lub Słodycze =
CALCULATE(
    [Sprzedaż Netto],
    [SLOT:0]
)
```

## Poprawne rozwiązanie
dKategorie[Kategoria] IN {NAPOJE, SŁODYCZE}

## Feedback poprawny
✅ **Brawo! Rozwiązanie poprawne!**

Operator `IN` pozwala elegancko sprawdzić, czy wartość znajduje się w zestawie: `dKategorie[Kategoria] IN {NAPOJE, SŁODYCZE}`. To czytelniejsze i krótsze niż wielokrotne użycie operatora `||` (OR). Zestaw wartości ujmujemy w nawiasy klamrowe `{}`.

## Wskazówka
Szukasz operatora, który w języku angielskim oznacza w (jako przynależność do zbioru). Wartości umieszczamy w nawiasach klamrowych.

---

# Łączenie filtrów - operator AND

Chcesz policzyć sprzedaż dla kategorii NAPOJE tylko w dni robocze (DzienTygodnia od 1 do 5). Jak połączyć oba warunki?

## Dostępne funkcje
- &&
- ||
- AND()
- Zarówno && jak i AND()

## Kod do uzupełnienia

```dax
DAX
Sprzedaż Napoje Dni Robocze =
CALCULATE(
    [Sprzedaż Netto],
    dKategorie[Kategoria] = NAPOJE [SLOT:0]
    dKalendarz[DzienTygodnia] >= 1 [SLOT:1] dKalendarz[DzienTygodnia] <= 5
)
```

## Poprawne rozwiązanie
&&, &&

## Feedback poprawny
✅ **Brawo! Rozwiązanie poprawne!**

Operator `&&` łączy warunki logiczne operatorem AND (i) - wszystkie muszą być spełnione jednocześnie. Możesz też użyć funkcji `AND()`, ale operator `&&` jest częściej używany i czytelniejszy w tego typu wyrażeniach. Alternatywnie można też rozdzielić filtry przecinkami w CALCULATE - działają wtedy jako AND.

## Wskazówka
Potrzebujesz operatora logicznego i - oba warunki muszą być prawdziwe. Szukasz dwóch znaków, które często w programowaniu oznaczają AND.

---

# Udział w sprzedaży całkowitej

Chcesz obliczyć procent udziału sprzedaży w danym okresie w stosunku do całkowitej sprzedaży ze wszystkich okresów. Jaką funkcję użyć do usunięcia filtra daty?

## Dostępne funkcje
- ALLSELECTED(dKalendarz)
- REMOVEFILTERS(dKalendarz)
- FILTER(dKalendarz, TRUE())
- CALCULATE(dKalendarz)

## Kod do uzupełnienia

```dax
DAX
Sprzedaż Cały Okres =
CALCULATE(
    [Sprzedaż Netto],
    [SLOT:0]
)

Udział % =
DIVIDE(
    [Sprzedaż Netto],
    [Sprzedaż Cały Okres]
)
```

## Poprawne rozwiązanie
REMOVEFILTERS(dKalendarz)

## Feedback poprawny
✅ **Brawo! Rozwiązanie poprawne!**

`REMOVEFILTERS(dKalendarz)` usuwa wszystkie filtry z tabeli kalendarza, dzięki czemu `[Sprzedaż Cały Okres]` pokazuje sumę dla wszystkich dat, niezależnie od kontekstu nałożonego na wizualizację. Możesz też użyć `ALL(dKalendarz)` - działa identycznie.

## Wskazówka
Szukasz funkcji, która w nazwie ma usuń filtry lub wszystkie (ang. remove/all). Materiał wspomina dwie równoważne opcje.

---

# Kontekst filtrowania

Co to jest kontekst filtrowania w Power BI?

## Dostępne funkcje
- Zbiór filtrów aktywnych w danym momencie obliczeń
- Lista wszystkich tabel w modelu
- Funkcja do filtrowania danych
- Tryb edycji filtrów w wizualizacji

## Kod do uzupełnienia

```dax
DAX
-- Gdy na wykres nałożysz kolumnę Kategoria,
-- tworzy się [SLOT:0], który określa
-- jakie wiersze są brane pod uwagę w obliczeniach
```

## Poprawne rozwiązanie
Zbiór filtrów aktywnych w danym momencie obliczeń

## Feedback poprawny
✅ **Brawo! Rozwiązanie poprawne!**

Kontekst filtrowania (filter context) to zbiór filtrów aktywnych w danym momencie obliczeń. Określa on jakie wiersze z tabel są brane pod uwagę. Gdy naniesiesz kolumnę na wizualizację, staje się ona częścią kontekstu filtrowania - miary są obliczane osobno dla każdej wartości tej kolumny.

## Wskazówka
Kontekst oznacza środowisko lub warunki. Kontekst filtrowania to warunki określające, które dane są aktualnie widoczne.

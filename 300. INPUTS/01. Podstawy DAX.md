---
type: teoria
---
## Czym jest DAX?

**DAX (Data Analysis Expressions)** to język formuł używany w Power BI, Excel Power Pivot i Analysis Services do tworzenia:

- **Miar** (measures) – dynamicznych obliczeń
- **Kolumn kalkulowanych** – stałych wartości w tabelach
- **Tabel kalkulowanych** – nowych tabel powstałych z obliczeń

DAX pozwala na analizę danych, tworzenie raportów i budowanie zaawansowanej logiki biznesowej.

---
## Odwoływanie się do tabel i kolumn

### Podstawowa składnia

W DAX zawsze odwołujesz się do kolumn poprzez **nazwę tabeli** i **nazwę kolumny** w nawiasach kwadratowych:

```dax
DAX
Sprzedaz[Cena]
```

**Zasady:**

- Nazwa tabeli **przed** nawiasem kwadratowym
- Nazwa kolumny **w** nawiasach kwadratowych
- To zapobiega niejednoznaczności gdy masz kolumny o tych samych nazwach w różnych tabelach

---

### Nazwy z apostrofami 

Jeśli nazwa tabeli lub kolumny zawiera:

- Spacje
- Znaki specjalne (np. `-`, `#`, `%`)
- Polskie znaki

Musisz ująć je w **apostrofy** `'`:

```dax
DAX
'Tabela Sprzedaży'[Kwota Netto]
'Dane-Produktów'[Nazwa Produktu]
'2024 Wyniki'[Przychód]
Produkty[Cena (netto)]
```

**Przykład błędny:**

```dax
DAX
Tabela Sprzedaży[Kwota Netto]  -- ❌ Błąd składni!
```

**Przykład poprawny:**

```dax
DAX
'Tabela Sprzedaży'[Kwota Netto]  -- ✅ Działa
```

---

### Odwoływanie się do miar

Miary (measures) odwołujesz się **bez nazwy tabeli**, tylko w nawiasach kwadratowych:

```dax
DAX
[Suma Sprzedaży]
[Średnia Cena]
[Liczba Klientów]
```

Możesz też użyć pełnej notacji z nazwą tabeli, ale nie jest to wymagane:

```dax
DAX
Sprzedaz[Suma Sprzedaży]  -- Działa, ale zwykle niepotrzebne
```

---
## Typy danych w DAX

DAX obsługuje kilka podstawowych typów danych:

| Typ                   | Przykład                           | Opis                    |
| --------------------- | ---------------------------------- | ----------------------- |
| **Liczby całkowite**  | `100`, `-50`                       | Integer                 |
| **Liczby dziesiętne** | `123.45`, `0.99`                   | Decimal/Float           |
| **Tekst**             | `"Warszawa"`, `"ABC"`              | String (w cudzysłowach) |
| **Data**              | `DATE(2024, 12, 8)`                | Date                    |
| **Data i czas**       | `DATETIME(2024, 12, 8, 14, 30, 0)` | DateTime                |
| **Logiczne**          | `TRUE`, `FALSE`                    | Boolean                 |
| **Puste**             | `BLANK()`                          | Null/Empty              |

---

## Operatory matematyczne

```dax
DAX
+   -- Dodawanie
-   -- Odejmowanie
*   -- Mnożenie
/   -- Dzielenie
^   -- Potęgowanie
```

**Przykład:**

```dax
DAX
Marża = 
Sprzedaz[Wartość Netto] - Sprzedaz[Koszty Netto]
```

---

## Operatory porównania

```dax
DAX
=   -- Równe
<>  -- Różne od
>   -- Większe niż
<   -- Mniejsze niż
>=  -- Większe lub równe
<=  -- Mniejsze lub równe
```

**Przykład:**

```dax
DAX
Czy Duża Sprzedaż = 
Sprzedaz[Cena] > 1000
```

---

## Operatory logiczne

```dax
DAX
&&  -- AND (i)
||  -- OR (lub)
NOT -- NOT (negacja)
```

**Przykład:**

```dax
DAX
Czy Premium = 
Sprzedaz[Kategoria] = "VIP" && Klienci[Przychód] > 10000
```

---

## Operator łączenia tekstów

```dax
DAX
&   -- Konkatenacja (łączenie tekstów)
```

**Przykład:**

```dax
DAX
Pełna Nazwa = 
Sprzedaz[Kategoria] & " - " & Sprzedaz[Nazwa Produktu]
```

---

#  Funkcje agregujące

## SUM – Suma wartości

Sumuje wszystkie wartości w kolumnie:

```dax
DAX
Suma Sprzedaży = SUM(Sprzedaz[Kwota])
```

**Jak działa:**

- Dodaje wszystkie liczby w kolumnie `Sprzedaz[Kwota]`
- Pomija wartości `BLANK()` (puste)
- Uwzględnia aktualny kontekst filtrowania

---

## AVERAGE – Średnia

Oblicza średnią arytmetyczną:

```dax
DAX
Średnia Cena = AVERAGE(Produkty[Cena])
```

**Jak działa:**

- Sumuje wszystkie wartości i dzieli przez ich liczbę
- Pomija wartości puste

---

## COUNT – Liczba wartości niepustych

Liczy ile jest niepustych wartości **numerycznych** w kolumnie:

```dax
DAX
Liczba Transakcji = COUNT(Sprzedaz[ID Transakcji])
```

**Uwaga:** COUNT liczy tylko wartości **niepuste** (pomija BLANK).

---

## COUNTA – Liczba wartości niepustych (dowolny typ)

Podobnie jak COUNT, ale działa na **wszystkich typach danych** (tekst, liczby, daty):

```dax
DAX
Liczba Produktów = COUNTA(Sprzedaz[Nazwa Produktu])
```

---

## COUNTROWS – Liczba wierszy w tabeli

Liczy wszystkie wiersze w tabeli (nawet jeśli mają puste wartości):

```dax
DAX
Liczba Zamówień = COUNTROWS(Sprzedaz)
```

**Różnica COUNT vs COUNTROWS:**

- `COUNT` – liczy niepuste wartości w **konkretnej kolumnie**
- `COUNTROWS` – liczy **wszystkie wiersze w tabeli**

---

## MIN i MAX – Minimum i maksimum

```dax
DAX
Najniższa Cena = MIN(Sprzedaz[Cena])
Najwyższa Cena = MAX(Sprzedaz[Cena])
```

---

## DISTINCTCOUNT – Liczba unikalnych wartości

Liczy ile jest **unikalnych** (niepowtarzających się) wartości:

```dax
DAX
Liczba Unikalnych Klientów = DISTINCTCOUNT(Sprzedaz[Ilość])
```

**Przykład:** Jeśli kolumna zawiera: `{1, 2, 2, 3, 3, 3}`, to `DISTINCTCOUNT` zwróci **3**.

---

#  Funkcje logiczne

## IF – Warunek logiczny

Zwraca jedną wartość jeśli warunek jest prawdziwy, inną jeśli fałszywy:

```dax
DAX
IF(<warunek>, <wartość_jeśli_prawda>, <wartość_jeśli_fałsz>)
```

**Przykład:**

```dax
DAX
Kategoria Sprzedaży = 
IF(
    Sprzedaz[Wartość Netto] > 1000,
    "Wysoka",
    "Niska"
)
```

---

## AND – Sprawdza czy wszystkie warunki są prawdziwe

```dax
DAX
AND(<warunek1>, <warunek2>)
```

**Przykład:**

```dax
DAX
Czy Duże Zamówienie = 
IF(
    AND(Sprzedaż[Wartość Sprzedaży] > 1000, Sprzedaż[Ilość] > 50),
    "TAK",
    "NIE"
)
```

---

## OR – Sprawdza czy przynajmniej jeden warunek jest prawdziwy

```dax
DAX
OR(<warunek1>, <warunek2>)
```

**Przykład:**

```dax
DAX
Napoje w Centralnej Polsce = 
IF(
    OR(Sprzedaz[Kategoria] = "NAPOJE", Sprzedaz[Region] = "Centralna Polska"),
    "TAK",
    "NIE"
)
```

---

## NOT – Negacja warunku

```dax
DAX
NOT(<warunek>)
```

**Przykład:**

```dax
DAX
Czy nie napój = 
IF(
    NOT(Sprzedaz[Kategoria] = "NAPOJE"),
    "TAK",
    "NIE"
)
```

---

#  Funkcje tekstowe

## CONCATENATE – Łączenie tekstów

```dax
DAX
CONCATENATE(<tekst1>, <tekst2>)
```

**Przykład:**

```dax
DAX
Pełna Nazwa = CONCATENATE(Sprzedaz[Kategoria], " - ", Sprzedaz[Nazwa Produktu])
```

**Alternatywa**

```dax
DAX
Pełna Nazwa = Sprzedaz[Kategoria] & " - " & Sprzedaz[Nazwa Produktu]
```

---

## LEFT, RIGHT, MID – Wyciąganie części tekstu

```dax
DAX
LEFT(<tekst>, <liczba_znaków>)    -- Pierwsze znaki od lewej
RIGHT(<tekst>, <liczba_znaków>)   -- Ostatnie znaki od prawej
MID(<tekst>, <start>, <liczba>)   -- Znaki ze środka
```

**Przykład:**

```dax
DAX
Pierwsze 3 Znaki = LEFT(Sprzedaz[Kategoria], 3)
Ostatnie 2 Znaki = RIGHT(Sprzedaz[Kategoria], 2)
```

---

## UPPER, LOWER – Zmiana wielkości liter

```dax
DAX
UPPER(<tekst>)  -- Wszystkie znaki WIELKIE
LOWER(<tekst>)  -- Wszystkie znaki małe
```

**Przykład:**

```dax
DAX
Kategoria Wielkie Litery = UPPER(Sprzedaz[Kategoria])
```

---

## LEN – Długość tekstu

```dax
DAX
LEN(<tekst>)
```

**Przykład:**

```dax
DAX
Długość Kodu = LEN(Sprzedaz[Kategoria])
```

---

#  Funkcje dat

## DATE – Tworzenie daty

```dax
DAX
DATE(<rok>, <miesiąc>, <dzień>)
```

**Przykład:**

```dax
DAX
Data Bazowa = DATE(2024, 1, 1)
```

---

## TODAY i NOW – Dzisiejsza data

```dax
DAX
TODAY()     -- Dzisiejsza data (bez godziny)
NOW()       -- Dzisiejsza data i godzina
```

**Przykład:**

```dax
DAX
Aktualna Data = TODAY()
```

---

## YEAR, MONTH, DAY – Wyciąganie składników daty

```dax
DAX
YEAR(<data>)   -- Rok
MONTH(<data>)  -- Miesiąc (1-12)
DAY(<data>)    -- Dzień (1-31)
```

**Przykład:**

```dax
DAX
Rok Sprzedaży = YEAR(Sprzedaz[Data Sprzedaży])
Miesiąc Sprzedaży = MONTH(Sprzedaz[Data Sprzedaży])
```

---

## DATEDIFF – Różnica między datami

```dax
DAX
DATEDIFF(<data_początkowa>, <data_końcowa>, <jednostka>)
```

**Jednostki:** DAY, MONTH, YEAR, QUARTER

**Przykład:**

```dax
DAX
Dni Od Zamówienia = 
DATEDIFF(Sprzedaz[Data Sprzedaży], TODAY(), DAY)
```


---
type: gaps
---

# Kolumna kalkulowana - kontekst

Tworzysz kolumnę kalkulowaną, która ma obliczyć marżę jako różnicę ceny i kosztu. Jak napisać formułę?

## Dostępne funkcje
- SUM(Sprzedaż[Cena]) - SUM(Sprzedaż[Koszt])
- Sprzedaż[Cena] - Sprzedaż[Koszt]
- CALCULATE(Sprzedaż[Cena] - Sprzedaż[Koszt])
- SUMX(Sprzedaż, Sprzedaż[Cena] - Sprzedaż[Koszt])

## Kod do uzupełnienia

```dax
DAX
Marża PLN = [SLOT:0]
```

## Poprawne rozwiązanie
Sprzedaż[Cena] - Sprzedaż[Koszt]

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

W kolumnach kalkulowanych możesz bezpośrednio odwoływać się do kolumn i wykonywać operacje matematyczne jak w Excelu: `Sprzedaż[Cena] - Sprzedaż[Koszt]`. Kolumny działają w kontekście wiersza - formuła oblicza się dla każdego wiersza osobno. Nie potrzebujesz funkcji agregujących.

## Feedback błędny - SUM(Sprzedaż[Cena]) - SUM(Sprzedaż[Koszt])
❌ **Niepoprawne!**

Funkcje agregujące jak `SUM()` są dla miar, nie dla kolumn kalkulowanych. W kolumnie masz kontekst wiersza - pracujesz na pojedynczym wierszu, więc bezpośrednio odwołujesz się do kolumn bez agregacji.

## Feedback błędny - CALCULATE
❌ **Niepoprawne!**

`CALCULATE()` służy do modyfikowania kontekstu filtrów w miarach. W kolumnach kalkulowanych nie potrzebujesz tej funkcji - po prostu odwołujesz się bezpośrednio do kolumn.

## Feedback błędny - SUMX
❌ **Niepoprawne!**

`SUMX()` to funkcja iteracyjna używana głównie w miarach. W kolumnie kalkulowanej już jesteś w kontekście wiersza, więc nie musisz iterować - po prostu odwołaj się do kolumn bezpośrednio.

## Wskazówka
W kolumnach kalkulowanych myślisz wierszami - możesz traktować kolumny jak zmienne i bezpośrednio je dodawać, odejmować, mnożyć.

---

# Miara - funkcje agregujące

Chcesz utworzyć miarę obliczającą marżę (przychód minus koszt). Jak to zrobić?

## Dostępne funkcje
- Sprzedaż[Wartość netto] - Sprzedaż[Koszt]
- SUM(Sprzedaż[Wartość netto]) - SUM(Sprzedaż[Koszt])
- SUMX(Sprzedaż, [Wartość netto] - [Koszt])
- AVERAGE(Sprzedaż[Wartość netto] - Sprzedaż[Koszt])

## Kod do uzupełnienia

```dax
DAX
Marża PLN = [SLOT:0]
```

## Poprawne rozwiązanie
SUM(Sprzedaż[Wartość netto]) - SUM(Sprzedaż[Koszt])

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

W miarach MUSISZ najpierw zagregować kolumny funkcjami jak `SUM()`, `AVERAGE()`, `COUNT()`, a dopiero potem wykonywać operacje matematyczne. Poprawnie: `SUM(Sprzedaż[Wartość netto]) - SUM(Sprzedaż[Koszt])`. Miary działają w kontekście filtrów, a nie kontekście wiersza.

## Feedback błędny - Sprzedaż[Wartość netto] - Sprzedaż[Koszt]
❌ **Niepoprawne!**

To składnia dla kolumn kalkulowanych, nie dla miar. W miarach NIE MOŻESZ bezpośrednio odejmować kolumn - musisz najpierw je zagregować: `SUM(Sprzedaż[Wartość netto]) - SUM(Sprzedaż[Koszt])`.

## Feedback błędny - SUMX
❌ **Niepoprawne!**

Choć `SUMX()` może działać, to w tym przypadku jest zbędna komplikacja. Wystarczy prosta agregacja: `SUM(kolumna1) - SUM(kolumna2)`. `SUMX()` jest potrzebna gdy obliczenia trzeba wykonać wiersz po wierszu przed sumowaniem.

## Feedback błędny - AVERAGE
❌ **Niepoprawne!**

`AVERAGE()` oblicza średnią, a nie sumę. Do obliczenia marży (różnicy sum) używamy `SUM()`.

## Wskazówka
W miarach myślisz agregacją - musisz najpierw zsumować każdą kolumnę osobno, a dopiero potem odjąć te sumy od siebie.

---

# Kiedy kolumna, a kiedy miara?

Chcesz utworzyć obliczenie Kategoria wiekowa klienta na podstawie daty urodzenia. Co powinieneś użyć?

## Dostępne funkcje
- Kolumnę kalkulowaną
- Miarę
- Tabelę kalkulowaną
- ParametrWhat-If

## Kod do uzupełnienia

```dax
DAX
-- Chcę móc filtrować klientów według kategorii wiekowej w slicerze
-- Wartość ma być stała dla każdego klienta

Rozwiązanie: [SLOT:0]
```

## Poprawne rozwiązanie
Kolumnę kalkulowaną

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

Kategoria wiekowa to wartość, którą chcesz używać do filtrowania i grupowania - idealne zastosowanie dla kolumny kalkulowanej. Kolumna zostanie obliczona dla każdego klienta osobno podczas odświeżania danych i będzie dostępna w slicerach. Wartość zależy tylko od danych w wierszu (data urodzenia), więc kolumna jest właściwym wyborem.

## Feedback błędny - Miarę
❌ **Niepoprawne!**

Miar NIE MOŻNA używać w slicerach ani do filtrowania wierszy. Miary są dynamiczne i zależą od kontekstu filtrów, a Ty potrzebujesz stałej wartości dla każdego klienta do filtrowania. To zadanie dla kolumny kalkulowanej.

## Feedback błędny - Tabelę kalkulowaną
❌ **Niepoprawne!**

Tabela kalkulowana tworzy całą nową tabelę. Ty potrzebujesz tylko nowej kolumny w istniejącej tabeli klientów. Kolumna kalkulowana to prostsze i właściwe rozwiązanie.

## Feedback błędny - Parametr What-If
❌ **Niepoprawne!**

Parametry What-If służą do tworzenia interaktywnych scenariuszy analitycznych (np. symulacji), nie do kategoryzacji danych według cech stałych jak wiek klienta.

## Wskazówka
Potrzebujesz wartości, którą można użyć do filtrowania i grupowania. Zastanów się: miary mogą być używane w slicerach?

---

# Przechowywanie w pamięci

Które obliczenie NIE jest przechowywane w modelu i nie zajmuje miejsca w pamięci?

## Dostępne funkcje
- Kolumna kalkulowana
- Miara
- Kolumna z Power Query
- Tabela kalkulowana

## Kod do uzupełnienia

```dax
DAX
-- To obliczenie jest wykonywane na żądanie podczas wyświetlania:
Odpowiedź: [SLOT:0]
```

## Poprawne rozwiązanie
Miara

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

Miary NIE są przechowywane w modelu - są obliczane dynamicznie w momencie wyświetlania wizualizacji. To oszczędza pamięć i pozwala na elastyczne reagowanie na filtry. Kolumny kalkulowane, kolumny z Power Query i tabele kalkulowane są wszystkie przechowywane w modelu i zajmują miejsce.

## Feedback błędny - Kolumna kalkulowana
❌ **Niepoprawne!**

Kolumny kalkulowane są obliczane podczas odświeżania danych i PRZECHOWYWANE w modelu. Zajmują miejsce w pamięci. To miara jest obliczana na żądanie i nie zajmuje miejsca.

## Feedback błędny - Kolumna z Power Query
❌ **Niepoprawne!**

Kolumny utworzone w Power Query (czy to źródłowe, czy przekształcone) są ładowane do modelu i PRZECHOWYWANE w pamięci. Tylko miary są obliczane dynamicznie bez przechowywania.

## Feedback błędny - Tabela kalkulowana
❌ **Niepoprawne!**

Tabele kalkulowane są generowane podczas odświeżania i PRZECHOWYWANE w modelu razem ze wszystkimi swoimi danymi. Zajmują miejsce w pamięci.

## Wskazówka
Szukasz typu obliczeń, który reaguje dynamicznie na filtry i działa na żądanie podczas wyświetlania raportu.

---

# Błąd - mnożenie kolumn w miarze

Próbujesz utworzyć miarę obliczającą wartość zamówień. Co jest nie tak z tym kodem?

## Dostępne funkcje
- Brak funkcji agregującej
- Złe nazwy kolumn
- Brak operatora mnożenia
- Użyto CALCULATE zamiast SUMX

## Kod do uzupełnienia

```dax
DAX
Wartość Zamówień = Sprzedaż[Ilość] * Sprzedaż[Cena]

Problem: [SLOT:0]
```

## Poprawne rozwiązanie
Brak funkcji agregującej

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

W miarach NIE MOŻESZ bezpośrednio mnożyć kolumn - brakuje funkcji agregującej. To częsty błąd początkujących. Poprawne rozwiązania to:
- `SUMX(Sprzedaż, Sprzedaż[Ilość] * Sprzedaż[Cena])` - oblicz dla każdego wiersza, potem zsumuj
- Lub stwórz kolumnę kalkulowaną z tym mnożeniem i użyj `SUM()` na tej kolumnie

## Feedback błędny - Złe nazwy kolumn
❌ **Niepoprawne!**

Nazwy kolumn są poprawnie zapisane (`Tabela[Kolumna]`). Problem nie leży w składni nazw, ale w braku agregacji wymaganej w miarach.

## Feedback błędny - Brak operatora mnożenia
❌ **Niepoprawne!**

Operator mnożenia `*` jest obecny w kodzie. Problem leży gdzie indziej - w braku funkcji agregującej, która jest wymagana w miarach.

## Feedback błędny - Użyto CALCULATE zamiast SUMX
❌ **Niepoprawne!**

W tym kodzie nie użyto ani CALCULATE, ani SUMX. Problem jest bardziej fundamentalny - brak jakiejkolwiek funkcji agregującej. W miarach nie można bezpośrednio mnożyć kolumn.

## Wskazówka
Zastanów się: w miarach możesz bezpośrednio wykonywać operacje na kolumnach jak w Excelu? Czego brakuje w porównaniu do składni kolumn kalkulowanych?

---

# Złota zasada

Która zasada pomaga zdecydować, czy użyć kolumny czy miary?

## Dostępne funkcje
- Jeśli używasz SUM/AVERAGE/COUNT → prawdopodobnie miara
- Zawsze używaj miar dla oszczędności pamięci
- Zawsze używaj kolumn dla szybkości obliczeń
- Jeśli dane się zmieniają → użyj miary

## Kod do uzupełnienia

```dax
DAX
-- Zasada decyzyjna:
[SLOT:0]
```

## Poprawne rozwiązanie
Jeśli używasz SUM/AVERAGE/COUNT → prawdopodobnie miara

## Feedback poprawny
✅ Brawo! Rozwiązanie poprawne!

Złota zasada: **Jeśli w formule używasz funkcji agregującej (`SUM`, `AVERAGE`, `COUNT`, itp.), prawie zawsze powinieneś tworzyć MIARĘ, nie kolumnę.** Jeśli możesz napisać formułę bez agregacji, tylko prostym odwołaniem do kolumn (jak w Excelu), prawdopodobnie potrzebujesz KOLUMNY.

## Feedback błędny - Zawsze używaj miar dla oszczędności pamięci
❌ **Niepoprawne!**

Choć miary oszczędzają pamięć, nie zawsze są właściwym wyborem. Nie możesz używać miar do filtrowania czy grupowania. Złota zasada to: jeśli używasz funkcji agregujących → miara, jeśli nie → kolumna.

## Feedback błędny - Zawsze używaj kolumn dla szybkości
❌ **Niepoprawne!**

To nie jest złota zasada. Kolumny są obliczane raz podczas odświeżania, ale zajmują pamięć. Decyzja zależy od tego, czy potrzebujesz agregacji i jak chcesz używać obliczeń (filtrowanie vs wartości na wykresach).

## Feedback błędny - Jeśli dane się zmieniają
❌ **Niepoprawne!**

Zmiany danych nie są kryterium wyboru między kolumną a miarą. Oba typy obliczeń odświeżają się wraz z danymi. Kluczowa różnica to: czy używasz agregacji i czy potrzebujesz filtrować według tej wartości.

## Wskazówka
Kluczem jest obecność funkcji agregujących w formule. Zastanów się, czy w wyrażeniu pojawia się SUM(), AVERAGE(), COUNT() lub podobne.
